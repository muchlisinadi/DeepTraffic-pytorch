from torchvision import datasets


class Malware2ClassSessionAllLayers(datasets.MNIST):
    """`Malware-MNIST <https://github.com/echowei/DeepTraffict>`_ Dataset.

    Args:
        root (string): Root directory of dataset where ``Malware2ClassSessionAllLayers/raw/train-images-idx3-ubyte``
            and  ``Malware2ClassSessionAllLayers/raw/t10k-images-idx3-ubyte`` exist.
        train (bool, optional): If True, creates dataset from ``train-images-idx3-ubyte``,
            otherwise from ``t10k-images-idx3-ubyte``.
        download (bool, optional): If True, downloads the dataset from the internet and
            puts it in root directory. If dataset is already downloaded, it is not
            downloaded again.
        transform (callable, optional): A function/transform that  takes in an PIL image
            and returns a transformed version. E.g, ``transforms.RandomCrop``
        target_transform (callable, optional): A function/transform that takes in the
            target and transforms it.
    """

    mirrors = [
        "http://raw.githubusercontent.com/echowei/DeepTraffic/master/1.malware_traffic_classification/3.PreprocessedResults/2class/SessionAllLayers/"
    ]
    resources = [
        ("train-images-idx3-ubyte.gz", "b4923c46b2a62f819b4c83953e1c88cd"),
        ("train-labels-idx1-ubyte.gz", "b919e86159ac6964e3629c61dd318f9d"),
        ("t10k-images-idx3-ubyte.gz", "1617428f409d25841c01a3d413a2b1a9"),
        ("t10k-labels-idx1-ubyte.gz", "170cff213368d27d67da68653a28b7b7"),
    ]
    classes = ["Benign", "Malign"]


class Malware2ClassSessionL7(datasets.MNIST):
    """`Malware-MNIST <https://github.com/echowei/DeepTraffict>`_ Dataset.

    Args:
        root (string): Root directory of dataset where ``Malware2ClassSessionL7/raw/train-images-idx3-ubyte``
            and  ``Malware2ClassSessionL7/raw/t10k-images-idx3-ubyte`` exist.
        train (bool, optional): If True, creates dataset from ``train-images-idx3-ubyte``,
            otherwise from ``t10k-images-idx3-ubyte``.
        download (bool, optional): If True, downloads the dataset from the internet and
            puts it in root directory. If dataset is already downloaded, it is not
            downloaded again.
        transform (callable, optional): A function/transform that  takes in an PIL image
            and returns a transformed version. E.g, ``transforms.RandomCrop``
        target_transform (callable, optional): A function/transform that takes in the
            target and transforms it.
    """

    mirrors = [
        "http://raw.githubusercontent.com/echowei/DeepTraffic/master/1.malware_traffic_classification/3.PreprocessedResults/2class/SessionL7/"
    ]
    resources = [
        ("t10k-images-idx3-ubyte.gz", "afa86f160169761fb8ac7cc5b53dd8f0"),
        ("t10k-labels-idx1-ubyte.gz", "57d1c637f6a202d510a1e42629d38332"),
        ("train-labels-idx1-ubyte.gz", "db9f6ee28fdfce6ad991644dc2881c7a"),
        ("train-images-idx3-ubyte.gz", "35b81e3ddaacfe41260c33e74d7a647a"),
    ]
    classes = ["Benign", "Malign"]


class Malware2ClassFlowAllLayers(datasets.MNIST):
    """`Malware-MNIST <https://github.com/echowei/DeepTraffict>`_ Dataset.

    Args:
        root (string): Root directory of dataset where ``Malware2ClassFlowAllLayers/raw/train-images-idx3-ubyte``
            and  ``Malware2ClassFlowAllLayers/raw/t10k-images-idx3-ubyte`` exist.
        train (bool, optional): If True, creates dataset from ``train-images-idx3-ubyte``,
            otherwise from ``t10k-images-idx3-ubyte``.
        download (bool, optional): If True, downloads the dataset from the internet and
            puts it in root directory. If dataset is already downloaded, it is not
            downloaded again.
        transform (callable, optional): A function/transform that  takes in an PIL image
            and returns a transformed version. E.g, ``transforms.RandomCrop``
        target_transform (callable, optional): A function/transform that takes in the
            target and transforms it.
    """

    mirrors = [
        "http://raw.githubusercontent.com/echowei/DeepTraffic/master/1.malware_traffic_classification/3.PreprocessedResults/2class/FlowAllLayers/"
    ]
    resources = [
        ("t10k-images-idx3-ubyte.gz", "1e1079937068547b0ff305c1f7bf9816"),
        ("t10k-labels-idx1-ubyte.gz", "2819d9bc592eb0d0236e5419e55fe1d0"),
        ("train-labels-idx1-ubyte.gz", "6a0608f49288cbc931ade4d536646781"),
        ("train-images-idx3-ubyte.gz", "9d015372355d8c363bf18b309cf10d6d"),
    ]
    classes = ["Benign", "Malign"]


class Malware2ClassFlowL7(datasets.MNIST):
    """`Malware-MNIST <https://github.com/echowei/DeepTraffict>`_ Dataset.

    Args:
        root (string): Root directory of dataset where ``Malware2ClassFlowL7/raw/train-images-idx3-ubyte``
            and  ``Malware2ClassFlowL7/raw/t10k-images-idx3-ubyte`` exist.
        train (bool, optional): If True, creates dataset from ``train-images-idx3-ubyte``,
            otherwise from ``t10k-images-idx3-ubyte``.
        download (bool, optional): If True, downloads the dataset from the internet and
            puts it in root directory. If dataset is already downloaded, it is not
            downloaded again.
        transform (callable, optional): A function/transform that  takes in an PIL image
            and returns a transformed version. E.g, ``transforms.RandomCrop``
        target_transform (callable, optional): A function/transform that takes in the
            target and transforms it.
    """

    mirrors = [
        "http://raw.githubusercontent.com/echowei/DeepTraffic/master/1.malware_traffic_classification/3.PreprocessedResults/2class/FlowL7/"
    ]
    resources = [
        ("t10k-images-idx3-ubyte.gz", "23d109ebc8371bdc040e805edc00a76f"),
        ("t10k-labels-idx1-ubyte.gz", "b0ef8b81181084f9aa9568ba69b22080"),
        ("train-labels-idx1-ubyte.gz", "17d1017cc5e32091b63ebccc88a267ff"),
        ("train-images-idx3-ubyte.gz", "281d92589d8673e9ecea9b9567e13b5b"),
    ]
    classes = ["Benign", "Malign"]
